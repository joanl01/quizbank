```{r data generation, echo = FALSE, results='hide'}
pacman::p_load(exams, tidyverse)
num <- sample(30:50, 1)
data <- data.frame(before = rnorm(num, mean = 3, sd = 2),
                   after = rnorm(num, mean = 4, sd = 4))
data <- round(data,0)
for(i in 1:num){
  if(data$before[i] > 10){
    data$before[i] <- 10
  } else if(data$before[i] < 0){
    data$before[i] <- 0
  }
}

for(j in 1:num){
  if(data$after[j] > 10){
    data$after[j] <- 10
  } else if(data$after[j] < 0){
    data$after[j] <- 0
  }
}
data$diff <- data$after - data$before

mytest <- t.test(data$diff)
ci_lb <- round(mytest$conf.int[1],3)
ci_ub <- round(mytest$conf.int[2],3)
choices <- character(4)
choices[1] <- paste0("95% of dogs had an increase in happiness index between ", ci_lb, " and ", ci_ub, " after receiving a treat")
choices[2] <-  paste0("We are 95% confident that the true mean increase in happiness index is  between ", ci_lb, " and ", ci_ub, " after receiving a treat")
choices[3] <- paste0("There is a 95% probability that the null hypothesis is true. ")
choices[4] <- paste0("The happiness index are normally distributed with mean = ", ci_lb," and variance = ", ci_ub)

sol <- c(F, T, F, F)

```



Question
=======================
A researcher wants to determine whether giving dogs a treat increases their happiness.
Each dog’s happiness index (on a scale from 0–10) is measured before and after receiving a treat.
There are `r num` dogs included in the study, the happiness index for each dog is measured twice, once before a treat and once after a treat. 

The researcher decides to use a matched pairs t-test to comapre if the happiness index of dogs increases after getting a treat.

Let `diff` be the difference in happiness index before and after getting a treat, which is calculated by:
`diff <- data$after - data$before`
The recorded data now looks like:
```{r showdata, echo=FALSE}
head(data)
```
A matched pairs t-test is then performed, and the output is shown below:
```{r showoutput, echo=FALSE}
print(mytest)
```


Which interpretation is correct about the 95% confidence interval? 
```{r questionlist, echo = FALSE, results = "asis"}
answerlist(choices,  markup = "markdown")
```




Solution
======================
The confidence level is interpreted by:
We are `CI level` confident that the true `parameter` of `population` lies between `lower` and `upper` `units`. 

The correct answer is 
```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(sol, markup = "markdown")
```




Meta-information
================
extype: mchoice
exsolution: `r mchoice2string(sol, single = TRUE)`
exname: matched-pairs-t-test-ci-interpret
exshuffle: TRUE

