```{r data generation, echo=FALSE, results='hide'}
pacman::p_load(tidyverse, exams)
## DATA GENERATION
n <- 10 + sample(1:5, 3)
dat <- data.frame(Energy = rnorm(sum(n),
    mean = rep(sample(seq(from = sample(50:70, 1), by = 1, length.out = sample(10:15, 1)), 3)/10, n),
    sd = rep(sample(60:80, 3)/100, n)),
  Diet = factor(rep(1:3, n),
    labels = c("Vegetarian", "Omnivore", "Vegan")))
dat$Energy[dat$Energy > 10] <- 10
dat$Energy[dat$Energy <  0] <-  0

## QUESTION/ANSWER GENERATION
questions <- character(5)
solutions <- logical(5)
explanations <- character(5)
myanova_print <- aov(data = dat, Energy ~ Diet) |> summary()
q2 <- "A one-sided alternative was tested for the mean energy levels."
sol <- FALSE
explain2 <- "ANOVA tests the null hypothesis that all mean values are equal against the alternative that at least one differs."


choices <- logical(2)
choices[2] <- TRUE


correct <- ifelse(choices == sol, 1,0)

```


Question
===============

A study with `r sum(n)` participants was conducted to evaluate the impact of different diet types on self-reported daily energy levels.
Participants rated their energy on an eleven-point scale from 0 (very low) to 10 (very high).
The evaluations are summarised by diet type in the following figure:

```{r boxplots, echo = FALSE, results = "hide", fig.height = 3.5, fig.width = 5.8, fig.path = "", fig.cap = ""}
par(mar = c(4, 4, 1, 1))
plot(Energy ~ Diet, data = dat)
```

To analyse whether the reported energy levels differ by diet, an ANOVA was performed:

```{r anova output, echo = FALSE, comment = NA}
options(show.signif.stars = FALSE)
print(myanova_print, quote = FALSE, right = TRUE)

```

Is the following statement correct? 

`r q2`

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(choices, markup = "markdown")
```


Solution
=============
`r explain2`

```{r solutions, echo=FALSE, results='asis'}
answerlist(ifelse(correct, "True", "False"), markup = "markdown")
```



Meta-information
================
extype: mchoice
exsolution: `r mchoice2string(correct, single = TRUE)`
exname: anova sided test 







