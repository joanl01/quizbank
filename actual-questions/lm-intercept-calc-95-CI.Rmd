```{r data generation, echo = FALSE, results='hide'}
pacman::p_load(tidyverse, exams)
n <- sample(30:100, 1)
# Daily study time (hours)
study_time <- runif(n, min = 0, max = 8)

# True relationship parameters
beta_0 <- 2.0   # baseline GPA
beta_1 <- 0.4   # GPA increase per study hour

# Generate GPA with noise
gpa <- beta_0 + beta_1 * study_time + rnorm(n, mean = 1, sd = 1)

# Keep GPA within 0â€“7
gpa <- pmin(pmax(gpa, 0), 7)

# Final dataset
data <- data.frame(
  study_time = study_time,
  gpa = gpa
)
data <- round(data,3)
# Fit linear regression model
model <- lm(gpa ~ study_time, data = data)
lala <- summary(model)
# Get coefficients, std error and t-value
slope <- lala$coefficients[2,1]
slop_se <- lala$coefficients[2,2]
crit_t <- qt(1-0.05/2, df = lala$df[2])

intercept <- lala$coefficients[1,1]
int_se <- lala$coefficients[2,2]


lb_slope <- round(slope - crit_t*slop_se,3)
ub_slope <- round(slope + crit_t*slop_se,3)

lb_int <- round(intercept - crit_t*int_se,3)
ub_int <- round(intercept + crit_t*int_se,3)


wrong1 <- round(slope - crit_t*slop_se/lala$df[1],3)
wrong2 <- round(slope + crit_t*slop_se/lala$df[1],3)

anotherwrong1 <- round(slope - crit_t*lala$sigma,3)
anotherwrong2 <- round(slope + crit_t*lala$sigma,3)

choices <- character(4)
choices[1] <- paste0("(",lb_int ,", ",ub_int , ")")
choices[2] <- paste0("(", wrong1 ,", ",wrong2 , ")")
choices[3] <- paste0("(", anotherwrong1 ,", ", anotherwrong2 , ")")
choices[4] <- paste0("(", lb_slope ,", ", ub_slope, ")")

sol <- c(T, F, F, F)




```

Question
===============
A researcher wants to know if daily study time (hours) actually has an effect on students final GPA score (from 0 to 7). They conducted a study with `r n` students, and recorded the students' daily study time and final GPA score. The dataset they collected looks like:
```{r showdata, echo=FALSE}
head(data)
```
The linear regression model is then fitted, the results are shown below:
```{r}
summary(model)
```
What is the 95% confidence interval for the intercept? Round your answer to 3 decimal places. You may assume the critical value $t^*$ is `r crit_t`
```{r questionlist, echo = FALSE, results = "asis"}
answerlist(choices,  markup = "markdown")
```

Solution
======================
The 95% confidence interval is calculated by 
$$ \beta_0 \pm t^* \times SE_{\beta_0}$$
From the output, $\beta_0 = $ `r intercept`, and $SE_\{\beta_0} = $ `r int_se`
The correct answer is 
```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(sol, markup = "markdown")
```

Meta-information
================
extype: mchoice
exsolution: `r mchoice2string(sol, single = TRUE)`
exname: lm-intercept-calc-95-CI
exshuffle: TRUE



