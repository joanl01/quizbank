```{r data generation, echo=FALSE, results='hide', warning=FALSE}
pacman::p_load(tidyverse, exams)
num <- sample(30:100, 1)

# Generate study mode
study_mode <- sample(
  c("On-campus", "Online"),
  size = num,
  replace = TRUE,
  prob = c(0.4, 0.6)
)

# Generate pet ownership CONDITIONAL on study mode
pet_ownership <- ifelse(
  study_mode == "Online",
  sample(c("Yes", "No"), sum(study_mode == "Online"),
         replace = TRUE, prob = c(0.7, 0.3)),
  sample(c("Yes", "No"), sum(study_mode == "On-campus"),
         replace = TRUE, prob = c(0.5, 0.5))
)

# Combine into data frame
student_data <- data.frame(
  StudyMode = study_mode,
  PetOwner = pet_ownership
)

# Contingency table
pet_table <- xtabs(~ StudyMode + PetOwner, data = student_data)

# Chi-square test
chi_test <- chisq.test(pet_table)

choices <- character(4)
choices[1] <- "`t.test(pet_table)`"
choices[2] <- "`t.test(StudyMode ~ PetOwner, data = student_data)`"
choices[3] <- "`aov(pet_table)`"
choices[4] <- "`chisq.test(pet_table)`"

sol <- c(F, F, F, T)

explain <- character(4)
explain[1] <- "This code would not work as `t.test` needs to work with a data frame"
explain[2] <- "This is code for a 2 sample t-test, which requires a numeric and a categorical variable"
explain[3] <- "This code is to conduct an ANOVA, which requires a numeric and a categorical variable (with multiple levels)"
```


Question
===================
A researcher records whether university students own a pet (Yes/No), and their study mode (Online/On-campus). The following contingency table is constrcuted from the data:
```{r showtable, echo=TRUE}
pet_table
```



Which R command correctly performs the chi-square test?
```{r questionlist, echo = FALSE, results = "asis"}
answerlist(choices,  markup = "markdown")
```




Solution
======================
The correct answer is 
```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(sol, explain, markup = "markdown")
```




Meta-information
================
extype: mchoice
exsolution: `r mchoice2string(sol, single = TRUE)`
exname: chi-square-which-code
exshuffle: TRUE

